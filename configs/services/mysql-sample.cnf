# MySQL Server Configuration
# Location: /etc/mysql/mysql.conf.d/mysqld.cnf
# 
# This is a sample configuration for MySQL/MariaDB
# Adjust values based on your system resources

[mysqld]

# Basic Settings
user                    = mysql
pid-file                = /var/run/mysqld/mysqld.pid
socket                  = /var/run/mysqld/mysqld.sock
port                    = 3306
basedir                 = /usr
datadir                 = /var/lib/mysql
tmpdir                  = /tmp
lc-messages-dir         = /usr/share/mysql

# Network Settings
bind-address            = 0.0.0.0  # Listen on all interfaces (change to 127.0.0.1 for local only)
max_connections         = 150
connect_timeout         = 10
wait_timeout            = 600
max_allowed_packet      = 64M
thread_cache_size       = 128
sort_buffer_size        = 4M
bulk_insert_buffer_size = 16M
tmp_table_size          = 32M
max_heap_table_size     = 32M

# Query Cache (disabled in MySQL 8.0+)
# query_cache_limit      = 128K
# query_cache_size       = 64M
# query_cache_type       = DEMAND

# Logging
log_error               = /var/log/mysql/error.log
# General query log (disable in production)
# general_log_file       = /var/log/mysql/mysql.log
# general_log            = 1

# Slow Query Log
slow_query_log          = 1
slow_query_log_file     = /var/log/mysql/mysql-slow.log
long_query_time         = 2

# InnoDB Settings
default_storage_engine  = InnoDB
innodb_buffer_pool_size = 256M  # Set to 70-80% of available RAM for dedicated DB server
innodb_log_file_size    = 64M
innodb_file_per_table   = 1
innodb_flush_method     = O_DIRECT
innodb_flush_log_at_trx_commit = 1  # 1 = full ACID, 2 = faster but less safe

# Security
# Disable LOAD DATA LOCAL INFILE
local-infile            = 0

# Character Set
character-set-server    = utf8mb4
collation-server        = utf8mb4_unicode_ci

# Binary Logging (for replication and point-in-time recovery)
# server-id              = 1
# log_bin                = /var/log/mysql/mysql-bin.log
# expire_logs_days       = 10
# max_binlog_size        = 100M
# binlog_format          = ROW

# Replication (Slave configuration)
# relay-log              = /var/log/mysql/mysql-relay-bin
# relay-log-index        = /var/log/mysql/mysql-relay-bin.index
# read_only              = 1

[mysqldump]
quick
quote-names
max_allowed_packet      = 64M

[mysql]
# Character set
default-character-set   = utf8mb4

[isamchk]
key_buffer              = 16M

# Instructions:
# 1. Copy this file to /etc/mysql/mysql.conf.d/mysqld.cnf
# 2. Adjust innodb_buffer_pool_size based on available RAM
# 3. Configure bind-address for network access
# 4. Restart MySQL: sudo systemctl restart mysql
# 5. Check status: sudo systemctl status mysql
